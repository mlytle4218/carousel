var container,inter,camera,scene,renderer,light,imagesArray,rotationRate=-.005,speed=0,radius=10,cameraDistance=35,quickZoom=35,mouseDown=!1,mouseOver=!1,timeStamp=null,prevMouseX=null,prevMouseY=null,averageX=[0,0],averageY=[0,0],raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,connectingElement="carousel",ambientLightColor=16777215;function start(e){initCar(imagesArray=createImagePlanes(e)),animateCar()}function createImagePlanes(e){var n=[],t=[];return e.files.forEach(function(e){t.push(e.pic)}),e.files.forEach(function(e){var t=new THREE.TextureLoader,o=new THREE.MeshLambertMaterial({map:t.load(e.pic)});o.transparent=!0;var a=new THREE.PlaneGeometry(15,15),r=new THREE.Mesh(a,o);r.position.set(0,-3,0),r.url=e.url,n.push(r)}),n}function loadObjModel(e){return new Promise(function(n,t){var o=new THREE.MTLLoader;o.setPath(e),o.load(name+".mtl",function(o){o.preload();var a=new THREE.OBJLoader;a.setMaterials(o),a.setPath(e),a.load(name+".obj",n,void 0,t)},void 0,t)})}function initCar(e){container=document.getElementById(connectingElement),(camera=new THREE.PerspectiveCamera(45,container.clientWidth/container.clientHeight,1,100)).position.set(0,-2,cameraDistance),mouse=new THREE.Vector2,scene=new THREE.Scene,(light=new THREE.AmbientLight(ambientLightColor)).position.set(0,10,0),scene.add(light),parent=new THREE.Object3D,scene.add(parent);for(var n=0,t=0;t<e.length;t++){var o=new THREE.Object3D;o.rotation.y=n*Math.PI/e.length,parent.add(o),e[t].position.z=15,e[t].rotation.y=-n*Math.PI/e.length,o.add(e[t]),n+=2}this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(container.clientWidth,container.clientHeight),renderer.gammaOutput=!0,container.appendChild(renderer.domElement)}function myLoader(e){var n=Math.floor(100/e.length),t=0;console.log(n),e.forEach(function(e){var o=new THREE.TextureLoader;new THREE.MeshLambertMaterial({map:o.load(e,o=>{t+=n,console.log(t+"% loaded"),(void 0).push(e)},e=>{console.log("progress")})})})}function onWindowResize(){camera.aspect=container.clientWidth/container.clientHeight,camera.updateProjectionMatrix(),renderer.setSize(container.clientWidth,container.clientHeight)}function animateCar(){requestAnimationFrame(animateCar),renderer.render(scene,camera),(speed<1e-4||speed>1e-4)&&(speed*=.99),rotateParent(mouseOver?getRotationRate()/2:getRotationRate())}function onMouseDown(e){if(inContainer({x:e.clientX,y:e.clientY})){mouseDown=!0,averageX=[0,0],averageY=[0,0],e.preventDefault(),raycaster.setFromCamera(mouse,camera);var n=raycaster.intersectObjects(scene.children,!0);n.length>0&&(inter=n[0])}}function onMouseUp(e){mouseDown=!1}function onMouseMove(e){var n={x:e.clientX,y:e.clientY};if(mouseDown&inContainer(n)){if(null===timeStamp)return timeStamp=Date.now(),prevMouseX=e.clientX,void(prevMouseY=e.clientY);var t=Date.now(),o=t-timeStamp,a=e.clientX-prevMouseX,r=e.clientY-prevMouseY,i=Math.round(a/o*100),c=(Math.round(r/o*100),Math.floor(container.clientWidth/6)+container.offsetLeft),s=4*Math.floor(container.clientWidth/6)+container.offsetLeft+c;if(e.clientX>c&e.clientX<s)if(a>0)rotateParent((e.clientX-c)/(4*Math.floor(container.clientWidth/6))*(Math.PI/180));else rotateParent(-((container.clientWidth-e.clientX-c)/(4*Math.floor(container.clientWidth/6)))*(Math.PI/180));mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1,averageX[0]+=i,averageX[1]++,timeStamp=t,prevMouseX=e.clientX,prevMouseY=e.clientY,(speed=averageX[0]/averageX[1]/1e3*.1)*rotationRate<0&&(rotationRate*=-1)}}function rotateParent(e){parent.rotation.y+=e;for(var n=0;n<parent.children.length;n++)parent.children[n].children[0].rotation.y+=-e}function toRadians(e){return e*(Math.PI/180)}function onMouseOver(e){var n={x:e.clientX,y:e.clientY};mouseOver=!!inContainer(n)}function inContainer(e){return!!(e.x>container.offsetLeft&e.x<container.offsetLeft+container.clientWidth&&e.y>container.offsetTop&e.y<container.offsetTop+container.clientHeight)}function onMouseOff(e){mouseOver=!1}function getRotationRate(){return mouseDown?0:speed*rotationRate<0?-rotationRate+speed:rotationRate+speed}window.addEventListener("resize",onWindowResize,!1),window.addEventListener("mousedown",onMouseDown,!1),window.addEventListener("mouseup",onMouseUp,!1),window.addEventListener("mousemove",onMouseMove,!1),window.addEventListener("mouseover",onMouseOver,!1),window.addEventListener("mouseout",onMouseOff,!1);